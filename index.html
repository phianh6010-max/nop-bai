<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Äiá»ƒm Danh Chung</title>
<style>
    body {
        background:#0f1724;
        font-family:Arial;
        color:white;
        padding:20px;
    }
    .box {
        max-width:450px;
        margin:auto;
        background:#ffffff15;
        padding:20px;
        border-radius:14px;
        backdrop-filter:blur(5px);
    }
    input {
        width:100%;
        padding:12px;
        margin-top:10px;
        border-radius:8px;
        border:none;
    }
    button {
        width:100%;
        padding:12px;
        margin-top:10px;
        border:none;
        border-radius:8px;
        font-weight:bold;
        cursor:pointer;
    }
    .ok {background:#00e1ff;color:#002;}
    .no {background:#ff5c5c;color:white;}
    .rank {
        margin-top:20px;
        background:#ffffff10;
        padding:15px;
        border-radius:10px;
    }
    .item {
        padding:8px;
        background:#ffffff10;
        border-radius:8px;
        margin-bottom:6px;
    }
</style>
</head>

<body>
<div class="box">
    <h2>ğŸ“Œ Äiá»ƒm danh chung</h2>
    <p>Nháº­p tÃªn vÃ  Ä‘iá»ƒm danh â€” má»i ngÆ°á»i Ä‘á»u sáº½ tháº¥y!</p>

    <input id="name" placeholder="Nháº­p tÃªnâ€¦">

    <button class="ok" onclick="diemDanh()">MÃ¬nh lÃ m rá»“i âœ…</button>
    <button class="no" onclick="chuaLam()">ChÆ°a lÃ m âŒ</button>

    <p id="msg" style="margin-top:10px;color:#7cf;"></p>

    <div class="rank">
        <h3>ğŸ“‹ Danh sÃ¡ch Ä‘iá»ƒm danh</h3>
        <div id="rankList">Äang táº£iâ€¦</div>
    </div>
</div>

<script>
let BIN_ID = localStorage.getItem("BIN_ID_DIEM_DANH");

// Náº¿u chÆ°a cÃ³ bin â†’ táº¡o má»›i
async function createBin(){
    let res = await fetch("https://json.extendsclass.com/bin", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify([])
    });

    let id = await res.text();
    localStorage.setItem("BIN_ID_DIEM_DANH", id);
    return id;
}

async function getBinId(){
    if(BIN_ID) return BIN_ID;
    BIN_ID = await createBin();
    return BIN_ID;
}

async function loadRank(){
    let id = await getBinId();
    let res = await fetch(`https://json.extendsclass.com/bin/${id}`);
    let data = await res.json();

    let html = "";
    data.forEach((name, i)=>{
        html += `<div class="item">#${i+1} â€” <b>${name}</b></div>`;
    });

    document.getElementById("rankList").innerHTML = html || "<i>ChÆ°a ai Ä‘iá»ƒm danhâ€¦</i>";
}

async function diemDanh(){
    let name = document.getElementById("name").value.trim();
    if(!name){
        document.getElementById("msg").innerText="Nháº­p tÃªn trÆ°á»›c Ä‘Ã£!";
        return;
    }

    let id = await getBinId();
    let res = await fetch(`https://json.extendsclass.com/bin/${id}`);
    let data = await res.json();

    if(!data.includes(name)) data.push(name);

    await fetch(`https://json.extendsclass.com/bin/${id}`, {
        method:"PUT",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify(data)
    });

    document.getElementById("msg").innerText = "Äiá»ƒm danh thÃ nh cÃ´ng ğŸ‰";
    loadRank();
}

function chuaLam(){
    document.getElementById("msg").innerText = "Mau lÃ m bÃ i lÃªn nÃ o ğŸ˜¤";
}

loadRank();
</script>

</body>
</html>
